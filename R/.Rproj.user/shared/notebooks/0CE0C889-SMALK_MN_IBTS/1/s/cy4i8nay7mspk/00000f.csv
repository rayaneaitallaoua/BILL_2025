"0","#tableau espèce cohorte sommes des effectifs pour chaque Area"
"0","df_cohorte <- aggregate(CANoAtLngt ~ Species + Cohorte + Area, data = tableau_donnees_filtrees, FUN = sum)"
"0","df_cohorte <- df_cohorte[order(df_cohorte$Species, df_cohorte$Cohorte),]"
"0",""
"0","#tableau permettant de savoir si le sex ratio est biaisé selon l'aire dans laquelle on pêche"
"0","df_cohorte_area_sex <- aggregate (CANoAtLngt ~ Species + Cohorte + Area + Sex, data = tableau_donnees_filtrees, FUN = sum)"
"0","df_cohorte_area_sex <- df_cohorte_area_sex[order(df_cohorte_area_sex$Cohorte),]"
"0","df_cohorte_area_sex <- df_cohorte_area_sex %>% pivot_wider(names_from = Sex, values_from = CANoAtLngt)"
"0","df_cohorte_area_sex$F[is.na(df_cohorte_area_sex$F)] <- 0"
"0","df_cohorte_area_sex$M[is.na(df_cohorte_area_sex$M)] <- 0"
"0","names(df_cohorte_area_sex)[names(df_cohorte_area_sex) == ""F""] <- ""Femelles"""
"0","names(df_cohorte_area_sex)[names(df_cohorte_area_sex) == ""M""] <- ""Males"""
"0","df_cohorte_area_sex <- mutate(df_cohorte_area_sex, SR = Males/(Femelles + Males))"
"0","tableau_cohorte_area_SR <- left_join(df_cohorte_area_sex, df_cohorte, by = c(""Species"", ""Cohorte"", ""Area""))"
"0","remove(df_cohorte_area_sex, df_cohorte)"
"0",""
"0","#colonne pourcentage"
"0","tableau_cohorte_area_SR <- tableau_cohorte_area_SR %>% group_by(Species, Cohorte) %>% mutate(pourcentage_eff = (CANoAtLngt/sum(CANoAtLngt))*100)"
"0","tableau_cohorte_area_SR$pourcent_eff<- round(tableau_cohorte_area_SR$pourcentage_eff, digits=2)"
"0","tableau_cohorte_area_SR <-tableau_cohorte_area_SR %>% select(-pourcentage_eff)"
"0",""
"0","#en valeur absolue"
"0","#g4<- "
"0","ggplot(tableau_cohorte_area_SR, aes(x = Cohorte, y = CANoAtLngt, by = Area, fill = as.factor(Area))) +"
"0","  geom_bar(stat=""identity"", position = position_stack(), width=1, color = ""black"") + #, show.legend = FALSE"
"0","  facet_wrap(~Species, scale = ""free"", ncol = 1) +"
"0","  ggtitle(""Distribution des effectifs en valeur absolue dans chaque aire de pêche, par espèces et par cohorte"") +"
"0","  #geom_text(aes(label = CANoAtLngt), stat = ""identity"", position = position_stack(.5), size = 2, color = ""black"")+  #on ne voit rien"
"0","  scale_fill_poke(pokemon = ""wigglytuff"" , spread = 10) +"
"0","  labs(fill = ""Aires \nde pêche"") +"
"0","  xlab(""Cohortes"") + "
"0","  ylab(""Effectifs"") "
