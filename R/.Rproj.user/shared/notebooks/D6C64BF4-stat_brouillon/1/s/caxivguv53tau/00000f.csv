"0","#rajouter traitement chaud, traitement froid et pas de traitement"
"0","table_sv <- table_sv %>% "
"0","  mutate(traitement_type = case_when(GENERATION == ""P15""~""non_traite"", "
"0","                                     (GENERATION != ""P15"" & ECHANTILLON <=5) ~ ""traitement_froid"","
"0","                                     (GENERATION != ""P15"" & ECHANTILLON > 5) ~ ""traitement_chaud""))"
"0","table_sv %>% names()"
"1","[1]"
"1"," ""ORF""             "
"1"," ""POSITION""        "
"1"," ""GENERATION""      "
"1"," ""ECHANTILLON""     "
"1"," ""FREQUENCE.ALL""   "
"1"," ""TYPE.DE.FICHIER"" "
"1"," ""LONGUEUR""        "
"1","
"
"1","[8]"
"1"," ""TYPE.DE.MUTATION"""
"1"," ""traitement_type"" "
"1","
"
"0","df_mut_sv <- table_sv %>% "
"0","  group_by(GENERATION, ECHANTILLON, TYPE.DE.MUTATION) %>%"
"0","  count()"
"0","  #pivot_wider(names_from = TYPE.DE.MUTATION)"
"0",""
"0",""
"0","names(df_mut_sv)[names(df_mut_sv) == ""n""] <- ""effectif_type_mutation"""
"0",""
"0","df_mut_sv <- left_join(df_mut_sv, unique(table_sv[,c(""GENERATION"", ""ECHANTILLON"", ""traitement_type"")]), by = c(""ECHANTILLON"", ""GENERATION"")) "
"0",""
"0",""
"0",""
"0","df_mut_sv2 <- df_mut_sv %>% aggregate(effectif_type_mutation ~ GENERATION + ECHANTILLON, FUN = sum)"
"0","names(df_mut_sv2)[names(df_mut_sv2) == ""effectif_type_mutation""] <- ""effectif_mutation"""
"0","df_mut_sv <- left_join(df_mut_sv, df_mut_sv2, by = c(""GENERATION"", ""ECHANTILLON""))"
"0","remove(df_mut_sv2)"
"0","df_mut_sv <- df_mut_sv %>% mutate(freq_mutation_type = effectif_type_mutation/effectif_mutation)"
"0","df_mut_sv$freq_mutation_type <- round(df_mut_sv$freq_mutation_type, 3)"
"0",""
"0","#frequence allélique par type de mutation"
"0","table_sv %>% names()"
"1","[1]"
"1"," ""ORF""             "
"1"," ""POSITION""        "
"1"," ""GENERATION""      "
"1"," ""ECHANTILLON""     "
"1"," ""FREQUENCE.ALL""   "
"1"," ""TYPE.DE.FICHIER"" "
"1"," ""LONGUEUR""        "
"1","
"
"1","[8]"
"1"," ""TYPE.DE.MUTATION"""
"1"," ""traitement_type"" "
"1","
"
"0","df <- table_sv %>% aggregate(FREQUENCE.ALL ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = mean)"
"0","df1 <- table_sv %>% aggregate(FREQUENCE.ALL ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = median)"
"0","df2 <- table_sv %>% aggregate(FREQUENCE.ALL ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = sd)"
"0","df3 <- table_sv %>% aggregate(FREQUENCE.ALL ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = max)"
"0","df4 <- table_sv %>% aggregate(FREQUENCE.ALL ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = min)"
"0",""
"0","names(df)[names(df) == ""FREQUENCE.ALL""] <- ""FREQUENCE.ALL_mean"""
"0","names(df1)[names(df1) == ""FREQUENCE.ALL""] <- ""FREQUENCE.ALL_median"""
"0","names(df2)[names(df2) == ""FREQUENCE.ALL""] <- ""FREQUENCE.ALL_sd"""
"0","names(df3)[names(df3) == ""FREQUENCE.ALL""] <- ""FREQUENCE.ALL_max"""
"0","names(df4)[names(df4) == ""FREQUENCE.ALL""] <- ""FREQUENCE.ALL_min"""
"0",""
"0","df <- left_join(df, df1, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df <- left_join(df, df2, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df <- left_join(df, df3, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df <- left_join(df, df4, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df_mut_sv <- left_join(df_mut_sv, df, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0",""
"0","remove(df, df1, df2, df3, df4)"
"0","#longueur du type de mutation par generation et échantillon"
"0","table_sv %>% names()"
"1","[1]"
"1"," ""ORF""             "
"1"," ""POSITION""        "
"1"," ""GENERATION""      "
"1"," ""ECHANTILLON""     "
"1"," ""FREQUENCE.ALL""   "
"1"," ""TYPE.DE.FICHIER"" "
"1"," ""LONGUEUR""        "
"1","
"
"1","[8]"
"1"," ""TYPE.DE.MUTATION"""
"1"," ""traitement_type"" "
"1","
"
"0","df <- table_sv %>% aggregate(LONGUEUR ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = mean)"
"0","df1 <- table_sv %>% aggregate(LONGUEUR ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = median)"
"0","df2 <- table_sv %>% aggregate(LONGUEUR ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = sd)"
"0","df3 <- table_sv %>% aggregate(LONGUEUR ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = max)"
"0","df4 <- table_sv %>% aggregate(LONGUEUR ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = min)"
"0",""
"0","names(df)[names(df) == ""LONGUEUR""] <- ""LONGUEUR_mean"""
"0","names(df1)[names(df1) == ""LONGUEUR""] <- ""LONGUEUR_median"""
"0","names(df2)[names(df2) == ""LONGUEUR""] <- ""LONGUEUR_sd"""
"0","names(df3)[names(df3) == ""LONGUEUR""] <- ""LONGUEUR_max"""
"0","names(df4)[names(df4) == ""LONGUEUR""] <- ""LONGUEUR_min"""
"0",""
"0","df <- left_join(df, df1, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df <- left_join(df, df2, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df <- left_join(df, df3, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df <- left_join(df, df4, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","df_mut_sv <- left_join(df_mut_sv, df, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION""))"
"0","remove(df, df1, df2, df3, df4)"
"0",""
"0","#nb de positions différentes concernées par generation par echantillon"
"0","table_sv$POSITION_factor <- as.factor(table_sv$POSITION)"
"0","nb_positions_gen_ech <- table_sv %>% aggregate(POSITION_factor ~ GENERATION + ECHANTILLON, FUN = function(x) length(unique(x)))"
"0","names(nb_positions_gen_ech)[names(nb_positions_gen_ech) == ""POSITION_factor""] <- ""nb_pos_gen_ech"""
"0","df_mut_sv <- left_join(df_mut_sv, nb_positions_gen_ech, by = c(""GENERATION"", ""ECHANTILLON"")) "
"0","remove(nb_positions_gen_ech)"
"0",""
"0","#nb de positions différentes concernées par generation par echantillon par type de mutation"
"0","nb_positions_gen_ech_type_mut <- table_sv %>% aggregate(POSITION_factor ~ GENERATION + ECHANTILLON + TYPE.DE.MUTATION, FUN = function(x) length(unique(x)))"
"0","names(nb_positions_gen_ech_type_mut)[names(nb_positions_gen_ech_type_mut) == ""POSITION_factor""] <- ""nb_pos_gen_ech_type_mut"""
"0","df_mut_sv <- left_join(df_mut_sv, nb_positions_gen_ech_type_mut, by = c(""GENERATION"", ""ECHANTILLON"", ""TYPE.DE.MUTATION"")) "
"0","remove(nb_positions_gen_ech_type_mut)"
"0",""
"0","df_mut_sv %>% names()"
"1"," [1]"
"1"," ""GENERATION""             "
"1"," ""ECHANTILLON""            "
"1"," ""TYPE.DE.MUTATION""       "
"1"," ""effectif_type_mutation"" "
"1"," ""traitement_type""        "
"1","
"
"1"," [6]"
"1"," ""effectif_mutation""      "
"1"," ""freq_mutation_type""     "
"1"," ""FREQUENCE.ALL_mean""     "
"1"," ""FREQUENCE.ALL_median""   "
"1"," ""FREQUENCE.ALL_sd""       "
"1","
"
"1","[11]"
"1"," ""FREQUENCE.ALL_max""      "
"1"," ""FREQUENCE.ALL_min""      "
"1"," ""LONGUEUR_mean""          "
"1"," ""LONGUEUR_median""        "
"1"," ""LONGUEUR_sd""            "
"1","
"
"1","[16]"
"1"," ""LONGUEUR_max""           "
"1"," ""LONGUEUR_min""           "
"1"," ""nb_pos_gen_ech""         "
"1"," ""nb_pos_gen_ech_type_mut"""
"1","
"
"0","df_mut_sv <- df_mut_sv %>% relocate(traitement_type, .after = ECHANTILLON)"
